apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: bank-bank-steward-1-node
  annotations:
    fluxcd.io/automated: "false"
  namespace: bank-ns
spec:
  releaseName: bank-bank-steward-1-node
  chart:
    path: platforms/hyperledger-indy/charts/indy-node
    git: ssh://git@github.com/sauveergoel/blockchain-automation-framework.git
    ref: indytest
  values:
    metadata:
      name: bank-bank-steward-1-node
      namespace: bank-ns
    network:
      name: baf
    organization:
      name: bank
    genesis:
      pool: eyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJkYXRhIjp7ImFsaWFzIjoidW5pdmVyc2l0eS1zdGV3YXJkLTEiLCJibHNrZXkiOiJqNFdRNjZkN2ZCUk1Wa29rY2M2M2JrY3hrTmFZelk1VmJySHpyWk1nd1JZQXRnN0Frb2lTNDNxaTNjRGdaZEJRckJjNTl0c1RXdzVLVE1Wd1h4QmU0U2N4ZEVSR1ZGQXY1bzdyWEZTdlJMaTRGUzhyZUEzcGE5cGRmZkJvUUNGYndBZzM2VXRvRFE1WmVRN3JZa0ZpdlJNWXFKTEhFaEtZdlk3emsyTEM0RFFQdkIiLCJibHNrZXlfcG9wIjoiUkFlS0Jpd0M4VTF0OFpCWFRuQWJCUlZ2ZzF5cjgyNnQzOEZwRVJjd1BMQzFtMWpQajlMZUdFaWl5c1JRRnhCNlZUQ0FQZDI1UEhlcVBOVUdrM3lldGdBbWFSY2o1NWtobnFDOVhHRHZuTXFxMmJ6U3VhVWRFNVJRN2pSb242Z3hlaHlEQ3l4ZkFocEN6c292ajRyd3RTNmh2VnJ4QUdVUWRHa1hKelg3TlFVNUV3IiwiY2xpZW50X2lwIjoiNTQuMjE2LjEwMi4yMjQiLCJjbGllbnRfcG9ydCI6MTUxMTIsIm5vZGVfaXAiOiI1NC4yMTYuMTAyLjIyNCIsIm5vZGVfcG9ydCI6MTUxMTEsInNlcnZpY2VzIjpbIlZBTElEQVRPUiJdfSwiZGVzdCI6IjRWejRQWDc5RWdWemRiVXVZWlhWWGdKSG9OZWU4bVlyRkF1SDRwQXQzc2JuIn0sIm1ldGFkYXRhIjp7ImZyb20iOiI3UlJiV0hHeVB4WGJ4WE5HNEt2YzhjIn0sInR5cGUiOiIwIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjoxLCJ0eG5JZCI6IjE2YmNlZjNkMTQwMjBlYWM1NTJlM2Y4OTNiODNmMDA4NDc0MjBhMDJjYmZkYzgwNTE3NDI1MDIzYjc1ZjEyNGUifSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJkYXRhIjp7ImFsaWFzIjoidW5pdmVyc2l0eS1zdGV3YXJkLTIiLCJibHNrZXkiOiIyM1JzWG5iWTVXWk5WdTloOWtlb3JNU1lEVFhhZGNXUGdHeExMYk1NbWJwUXRXYkt6ckhOMURBRHpIeXhnMnhLeXE5RDFxa1FFSDF0RE5HTTNOdkdIOTc1a3VTZVdzdDR5Q3NIOXFUS21qYXJ0N1NScEZqUjRCd25kc2hmTjRxUDJtRVNLWG1pUnpHNGRoTGZ4OUdNcmNTeTFCQzNMblZITGRhTTFtdll1ZzNjZ3h6IiwiYmxza2V5X3BvcCI6IlF1dXZOUGJNbnZYQkFYNFFOdzlmcW90MjNGQUdnN2NWakZvYVZZQ1IxRVQxTGY0R21IOXRRTXhrWHQxRWs3N0V5TXVwanVDTEZOMlQ3R2VGZUFNSkFxVVFXemtvNlIzNWpoNW9NdlVqMVhWTmVmdkpSbXhtUUxnOFVSTHZiWWNjcDlOUmlXUjJvVXRFTHAzTmlxdkR4YUIzd2J1SHBSa05VWlVrSjlxcXJKVFByRiIsImNsaWVudF9pcCI6IjU0LjIxNi4xMDIuMjI0IiwiY2xpZW50X3BvcnQiOjE1MTIyLCJub2RlX2lwIjoiNTQuMjE2LjEwMi4yMjQiLCJub2RlX3BvcnQiOjE1MTIxLCJzZXJ2aWNlcyI6WyJWQUxJREFUT1IiXX0sImRlc3QiOiI0NVVZbXNaRXBlVm9tWTUxQkhlcUVmVmg4UEhjWno5eDFGZnFxQUtOV1FFdCJ9LCJtZXRhZGF0YSI6eyJmcm9tIjoiNmVUVXV1VzZhZzY5clZ1UUtZOHAxSCJ9LCJ0eXBlIjoiMCJ9LCJ0eG5NZXRhZGF0YSI6eyJzZXFObyI6MiwidHhuSWQiOiJhYjMxNDZmY2JlMTljNjUyNWZjOWMzMjU3NzFkNmQ2NDc0ZjhkZGVjMGYyZGE0MjU3NzRhMTY4N2E0YWZlOTQ5In0sInZlciI6IjEifQogICAgICAgIHsicmVxU2lnbmF0dXJlIjp7fSwidHhuIjp7ImRhdGEiOnsiZGF0YSI6eyJhbGlhcyI6ImVtcGxveWVyLXN0ZXdhcmQtMSIsImJsc2tleSI6IjJxWHRaYUpRVVduOGYyN1pSejhFMzhYMVhldTh4UHBSbld5RXBScXRxcmpnenpUZ0ZtaUdpVjlpNkRFV0FNMm9BaktTQ2YyVUV0YWE0RXdSTTRKVHVIYmJ4cnM5RVJleEtTZlVyam9ZbWY0UzZVNXpHdW5jbkQxc2hqYjdnUEJFeWNCd2NvNjNmMmZidVV1QWhDMnRBTTFDdkh4U3JxWjdrZGpaN3dKV3A0TjI0S2YiLCJibHNrZXlfcG9wIjoiUXc2bXMybVFkcmZIVTY0MUs4WFh6M2k1RlRYZDZlbmNyUFU4WFY3aEZDekRyRjQ3cTZab2tSVVR0dTMyVDlQOUg5WmV4aUxHWld3UUZnWXd5QXpRYzROUEtKaWlkYTFLa1lQNzJBd2tWSllnQzU4WDJlQVRnVDdhQlZNZVh2a25ubmh1TnVIMXlDOWJZcEJkVDhLWTNIQzJKQWo3ZjM5RUJvc1p5RlhjYlZZbUFvIiwiY2xpZW50X2lwIjoiNTQuMjE2LjEwMi4yMjQiLCJjbGllbnRfcG9ydCI6MTUxMzIsIm5vZGVfaXAiOiI1NC4yMTYuMTAyLjIyNCIsIm5vZGVfcG9ydCI6MTUxMzEsInNlcnZpY2VzIjpbIlZBTElEQVRPUiJdfSwiZGVzdCI6IjJWSEppOGlvMjNlemV5emtZQjl1VVNqcVBVQUVheldTTTU3VkVGWERoUjY1In0sIm1ldGFkYXRhIjp7ImZyb20iOiIzakplNGFiR0pWWUJkNFNuampzcmZhIn0sInR5cGUiOiIwIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjozLCJ0eG5JZCI6ImQ4NTMzNGVkMWZiNTM3YjJmZjg2MjdiOGNjNGJjZjI1OTZkNWRhNjJjNmQ4NTI0NGI4MDY3NWViYWU5MWZkMDcifSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJkYXRhIjp7ImFsaWFzIjoiZW1wbG95ZXItc3Rld2FyZC0yIiwiYmxza2V5IjoiM3g2RjRqakdyUVV3TW83U05BOGdlUmM0aW43Yk16Q05TU0FhZ1o4Nk5jV1VkVEU1cW0zNUxKd1pMRmR5QWV6eDZLalZwcFUxYUFBOHp2clM0c1VyN1Q1WWNQNVdKcE1MYTdoREZZQ3BzV3NEUkV6TkJUcnl5UE1jVWplYWlBVjZnSnBraWtnSkhoQnZISEFHZUNmSkVMTjJHNmVFU1hEWHVMa0QzdXN0RDZvNVVwWSIsImJsc2tleV9wb3AiOiJRczRrWTh6VDdZOURFTG9FZ2VoTXRYUGRxTUFtMXNjV1VjSktaNDZkWXJUeGNXbnhZemlLOWZaVFdoTTVjUVFQMTZvb2lzYlA1U056TEc3cHFzcFBodG56TjNwbTJac05paTRUMzZZTUxMMUE0QVZIM3FIdFladXljVndlM2czVFd1ZFVRZlJ4YzFhVVRVZXo2OFhBSEhGeXI1TTJnZ29IUEtnejRrZDhWSFR6OFAiLCJjbGllbnRfaXAiOiI1NC4yMTYuMTAyLjIyNCIsImNsaWVudF9wb3J0IjoxNTE0Miwibm9kZV9pcCI6IjU0LjIxNi4xMDIuMjI0Iiwibm9kZV9wb3J0IjoxNTE0MSwic2VydmljZXMiOlsiVkFMSURBVE9SIl19LCJkZXN0IjoiNjlYdllXRHQ0NllmV1pGVXUxeW0yaWkzamVkMmdqR1NvQjZZMzVjUmNFNFUifSwibWV0YWRhdGEiOnsiZnJvbSI6IkFTalhBNFZwNjZRZFJHeWZwZE5DdkYifSwidHlwZSI6IjAifSwidHhuTWV0YWRhdGEiOnsic2VxTm8iOjQsInR4bklkIjoiMWIwZGNhNWNkNmZmZTUyNmFiNjVmMTcwNGIzNGVjMjQwOTZiNzVmNzlkNGMwNDY4YTYyNTIyOWVkNjg2ZjQyYSJ9LCJ2ZXIiOiIxIn0=
      domain: eyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJhbGlhcyI6ImF1dGhvcml0eS10cnVzdGVlIiwiZGVzdCI6IlhQV0V5ZHlOcVlFUUo4bWlWV3htY3kiLCJyb2xlIjoiMCIsInZlcmtleSI6IkhaZEVQbXZpTkNHVkI4TEdwZGoxNkQzYzduR0c4c2FhekphRHAxcUNHa05KIn0sIm1ldGFkYXRhIjp7fSwidHlwZSI6IjEifSwidHhuTWV0YWRhdGEiOnsic2VxTm8iOjF9LCJ2ZXIiOiIxIn0KICAgICAgICB7InJlcVNpZ25hdHVyZSI6e30sInR4biI6eyJkYXRhIjp7ImFsaWFzIjoidW5pdmVyc2l0eS10cnVzdGVlIiwiZGVzdCI6IjNxOEp0NTRzMnpRQm5tNEM5WlNWQ0giLCJyb2xlIjoiMCIsInZlcmtleSI6IjJZVE02c0FlY3FmOTQxUUpTbUFoYmZpSzVOaTdRSGpoRmNZTms5Y1BodVBLIn0sIm1ldGFkYXRhIjp7ImZyb20iOiJYUFdFeWR5TnFZRVFKOG1pVld4bWN5In0sInR5cGUiOiIxIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjoyfSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJhbGlhcyI6InVuaXZlcnNpdHktc3Rld2FyZC0xIiwiZGVzdCI6IjdSUmJXSEd5UHhYYnhYTkc0S3ZjOGMiLCJyb2xlIjoiMiIsInZlcmtleSI6IjRWejRQWDc5RWdWemRiVXVZWlhWWGdKSG9OZWU4bVlyRkF1SDRwQXQzc2JuIn0sIm1ldGFkYXRhIjp7ImZyb20iOiIzcThKdDU0czJ6UUJubTRDOVpTVkNIIn0sInR5cGUiOiIxIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjozfSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJhbGlhcyI6InVuaXZlcnNpdHktc3Rld2FyZC0yIiwiZGVzdCI6IjZlVFV1dVc2YWc2OXJWdVFLWThwMUgiLCJyb2xlIjoiMiIsInZlcmtleSI6IjQ1VVltc1pFcGVWb21ZNTFCSGVxRWZWaDhQSGNaejl4MUZmcXFBS05XUUV0In0sIm1ldGFkYXRhIjp7ImZyb20iOiIzcThKdDU0czJ6UUJubTRDOVpTVkNIIn0sInR5cGUiOiIxIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjo0fSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJhbGlhcyI6ImVtcGxveWVyLXRydXN0ZWUiLCJkZXN0IjoiSzNZcG9wN0NIV3FtZUxjeWc5dllubSIsInJvbGUiOiIwIiwidmVya2V5IjoiQXFRVTdGSDRqNjQ2UnlYSDF1cnl2Z3JBRWZwYmJ0S2tHamlhUWhHMmVRZ04ifSwibWV0YWRhdGEiOnsiZnJvbSI6IlhQV0V5ZHlOcVlFUUo4bWlWV3htY3kifSwidHlwZSI6IjEifSwidHhuTWV0YWRhdGEiOnsic2VxTm8iOjV9LCJ2ZXIiOiIxIn0KICAgICAgICB7InJlcVNpZ25hdHVyZSI6e30sInR4biI6eyJkYXRhIjp7ImFsaWFzIjoiZW1wbG95ZXItc3Rld2FyZC0xIiwiZGVzdCI6IjNqSmU0YWJHSlZZQmQ0U25qanNyZmEiLCJyb2xlIjoiMiIsInZlcmtleSI6IjJWSEppOGlvMjNlemV5emtZQjl1VVNqcVBVQUVheldTTTU3VkVGWERoUjY1In0sIm1ldGFkYXRhIjp7ImZyb20iOiJLM1lwb3A3Q0hXcW1lTGN5Zzl2WW5tIn0sInR5cGUiOiIxIn0sInR4bk1ldGFkYXRhIjp7InNlcU5vIjo2fSwidmVyIjoiMSJ9CiAgICAgICAgeyJyZXFTaWduYXR1cmUiOnt9LCJ0eG4iOnsiZGF0YSI6eyJhbGlhcyI6ImVtcGxveWVyLXN0ZXdhcmQtMiIsImRlc3QiOiJBU2pYQTRWcDY2UWRSR3lmcGROQ3ZGIiwicm9sZSI6IjIiLCJ2ZXJrZXkiOiI2OVh2WVdEdDQ2WWZXWkZVdTF5bTJpaTNqZWQyZ2pHU29CNlkzNWNSY0U0VSJ9LCJtZXRhZGF0YSI6eyJmcm9tIjoiSzNZcG9wN0NIV3FtZUxjeWc5dllubSJ9LCJ0eXBlIjoiMSJ9LCJ0eG5NZXRhZGF0YSI6eyJzZXFObyI6N30sInZlciI6IjEifQ==
      type: add-org
    image:
      pullSecret: regcred
      initContainer:
        name: bank-bank-steward-1-node-init
        repository: alpine:3.9.4
      cli:
        name: bank-bank-steward-1-node-ledger-txn
        repository: index.docker.io/hyperledgerlabs/indy-ledger-txn:latest
        pullSecret: regcred  
      indyNode:
        name: bank-bank-steward-1-node
        repository: index.docker.io/hyperledgerlabs/indy-node:1.11.0
    node:
      name: bank-steward-1
      ip: 0.0.0.0
      publicIp: 54.216.102.224
      port: 9751
      ambassadorPort: 15151
    client:
      publicIp: 54.216.102.224
      ip: 0.0.0.0
      port: 9752
      ambassadorPort: 15152
    service:
      type: ClusterIP
      ports:
        nodePort: 9751
        nodeTargetPort: 9751
        clientPort: 9752
        clientTargetPort: 9752
    configmap:
      indyConfig: |-
        NETWORK_NAME = 'baf'
        # Enable stdout logging
        enableStdOutLogging = True
        logRotationBackupCount = 10
        # Directory to store ledger.
        LEDGER_DIR = '/var/lib/indy/data'
        # Directory to store logs.
        LOG_DIR = '/var/log/indy'
        # Directory to store keys.
        KEYS_DIR = '/var/lib/indy/keys'
        # Directory to store genesis transactions files.
        GENESIS_DIR = '/var/lib/indy/genesis'
        # Directory to store backups.
        BACKUP_DIR = '/var/lib/indy/backup'
        # Directory to store plugins.
        PLUGINS_DIR = '/var/lib/indy/plugins'
        # Directory to store node info.
        NODE_INFO_DIR = '/var/lib/indy/data'
    ambassador:
      annotations: |-
        ---
        apiVersion: ambassador/v1
        kind: TCPMapping
        name: bank-bank-steward-1-node-node-mapping
        port: 15151
        service: bank-bank-steward-1-node.bank-ns:9751
        ---
        apiVersion: ambassador/v1
        kind: TCPMapping
        name: bank-bank-steward-1-node-client-mapping
        port: 15152
        service: bank-bank-steward-1-node.bank-ns:9752
    vault:
      address: http://ab0e697583dfc447b8d14e6526e14759-1481581572.eu-west-1.elb.amazonaws.com:20002
      serviceAccountName: bank-bank-steward-1-vault-auth
      keyPath: /keys/baf/keys/bank-steward-1
      authPath: kubernetes-bank-bank-steward-1-auth
      nodeId: bank-steward-1
      role: ro
    storage:
      data:
        storagesize: 3Gi
        storageClassName: bank-aws-storageclass
      keys:
        storagesize: 3Gi
        storageClassName: bank-aws-storageclass
